angular.module("software.bytepushers.data.provider",[]),angular.module("software.bytepushers.data.provider").provider("DataProvider",function(){"use strict";var a;this.$get=function(){if(!angular.isDefined(a))throw new BytePushers.dao.DaoException("No DAO Configuration defined.");if(!angular.isArray(a.entities))throw new BytePushers.dao.DaoException("No DAO Entity Configurations defined.");if(angular.isArray(a.entities)&&0===a.entities.length)throw new BytePushers.dao.DaoException("No DAO Entity Configurations defined.");return a.entities.forEach(function(a){BytePushers.dao.DaoManager.getInstance().registerDao({name:"pmms-mobile-app",version:1,storeName:"pmms-mobile-app-data-store",description:"PMMS Mobile App Data Store",Entity:a,Dao:BytePushers.dao.LocalForageDao,dataStore:localforage,entityConfigs:{personEntityConfig:{entityIdValidationMethod:function(){return!0}}}})}),BytePushers.dao.DaoManager.getInstance()},this.setDataProviderConfig=function(b){a=b},this.getDataProviderConfig=function(){return a}}),function(a,b){"use strict";void 0!==a.BytePushers&&null!==a.BytePushers?b=a.BytePushers:(a.BytePushers={},b=a.BytePushers),b.dao=b.dao||b.namespace("software.bytepushers.data.dao"),b.dao.DaoException=function(a){b.dao.DaoException.prototype.superclass.apply(this,[a]),this.name="BytePushers.dao.DaoException",this.message=a},b.dao.DaoException.prototype=b.inherit(Error.prototype),b.dao.DaoException.prototype.constructor=b.dao.DaoException,b.dao.DaoException.prototype.superclass=Error,b.dao.DaoException.prototype.toString=function(){return this.name+"("+this.message+")"}}(window,BytePushers),function(a){"use strict";a=a||{},a.dao=a.dao||a.namespace("software.bytepushers.data.dao"),a.dao.DaoManager=function(){function b(){function b(b,c){var d;if(!Object.isConstructorFunction(b))throw new a.dao.DaoException("DAO Adapter(\n\n"+b.name+"\n\n) constructor method must be defined.");if(!Object.isDefined(c))throw new a.dao.DaoException("Entity Name(\n\n"+c+"\n\n) must be defined.");if(Object.isConstructorFunction(b)&&(d=b.name.substringBefore("LocalForageDao"),d=b.name.substringBefore("BaseDao"),d=b.name.substringBefore("Dao"),0===d.trim().length))throw new a.dao.DaoException("DAO Adapter("+b.name+") constructor method must be prefixed with the name of the platform it implements.  For example, 'LocalForage' is the prefix in 'LocalForageBaseDaoAdapter'.");return c+d+"Dao"}function c(b){var c;if(!Object.isConstructorFunction(b))throw new a.dao.DaoException("Entity("+b+") constructor method must be defined.");return c=b.name}function d(a,b){var c;a=Object.isDefined(a)?a:{},b=Object.isDefined(b)?b:{};for(c in b)b.hasOwnProperty(c)&&(a[c]=b[c])}function e(b){if(!Object.isDefined(b))throw new a.dao.DaoException("DAO Configuration must be defined.");if(!Object.isConstructorFunction(b.Entity))throw new a.dao.DaoException("DAO Configuration must define an Entity.");return b.Entity}function f(b){if(!Object.isDefined(b))throw new a.dao.DaoException("DAO Configuration must be defined.");if(!Object.isConstructorFunction(b.Dao))throw new a.dao.DaoException("DAO Configuration must define an DAO.");return b.Dao}function g(a){return h=a}var h,i=[];this.registerDao=function(d){var h=e(d),j=f(d),k=c(h),l=b(j,k),m=l+"Impl",n=new Function("daoConfig","return function "+l+"() {this.__proto__.superclass.apply(this, [daoConfig]); }")(g(d));n.prototype=a.inherit(a.dao.LocalForageDao.prototype),n.prototype.constructor=n,n.prototype.superclass=a.dao.LocalForageDao,i[l]=n,i[m]=null},this.getDao=function(a,b){var c=null;return d(h,b),Object.isDefined(i[a])&&("object"==typeof i[a]&&(c=i[a]),Object.isConstructorFunction(i[a])&&(c=new i[a])),c}}var c,d;return d={getInstance:function(a){return void 0===c&&(c=new b(a)),c}}}()}(BytePushers),function(a){"use strict";function b(a){return Object.isDefined(a)&&Object.isDefined(a.entity)&&Object.isFunction(a.entity.validationMethods.isValidEntityId)?a.entityIdValidationMethod:function(){return!0}}a=a||{},a.dao=a.dao||a.namespace("software.bytepushers.data.dao"),a.dao.GenericDAO=function(a){var c=Object.isDefined(a)&&Object.isFunction(a.Entity)?a.Entity:null,d=b(a);this.getEntity=function(){return c},this.isEntityIdValid=function(){d()}},a.dao.GenericDAO.prototype.isEntityIdValid=function(){this.isEntityIdValid()},a.dao.GenericDAO.prototype.createEntity=function(b){var c,d=this.getEntity();if(!a.dao.GenericDAO.prototype.isPrototypeOf(this))throw new a.dao.DaoException("Can not call object unless in Object's hierarchy prototype chain.");return c=new d(b)},a.dao.GenericDAO.prototype.create=function(){if(!a.dao.GenericDAO.prototype.isPrototypeOf(this))throw new a.dao.DaoException("Can not call object unless in Object's hierarchy prototype chain.");throw new a.dao.DaoException("abstract method")},a.dao.GenericDAO.prototype.read=function(){if(!a.dao.GenericDAO.prototype.isPrototypeOf(this))throw new a.dao.DaoException("Can not call object unless in Object's hierarchy prototype chain.");throw new a.dao.DaoException("abstract method")},a.dao.GenericDAO.prototype.update=function(){if(!a.dao.GenericDAO.prototype.isPrototypeOf(this))throw new a.dao.DaoException("Can not call object unless in Object's hierarchy prototype chain.");throw new a.dao.DaoException("abstract method")},a.dao.GenericDAO.prototype["delete"]=function(){if(!a.dao.GenericDAO.prototype.isPrototypeOf(this))throw new a.dao.DaoException("Can not call object unless in Object's hierarchy prototype chain.");throw new a.dao.DaoException("abstract method")}}(BytePushers),function(a,b){"use strict";var c=null,d=function(b){if(!Object.isDefined(b.value))throw new a.exceptions.InvalidParameterException(b.description+": must be defined: "+b.value);if(this.isEntityIdValid(b.value))throw new a.exceptions.InvalidParameterException(b.description+": must be defined: "+b.value)},e=function(b){if(!Object.isDefined(b.value))throw new a.exceptions.InvalidParameterException(b.description+": must be defined: "+b.value)},f=function(a,b,c){try{c(a)}catch(d){if(Error.prototype.isPrototypeOf(b))throw new b(d)}},g=function(b){var c,d;if(!Object.isDefined(b))throw new a.dao.DaoException("LocalForage Config must be defined.");if(!Object.isDefined(b.name))throw new a.dao.DaoException("LocalForage Config: Data Store App Name must be defined.");if(!Object.isDefined(b.version))throw new a.dao.DaoException("LocalForage Config: Data Store Version must be defined.");if(!Object.isDefined(b.storeName))throw new a.dao.DaoException("LocalForage Config: Data Store Name must be defined.");if(!Object.isDefined(b.dataStore))throw new a.dao.DaoException("LocalForage Config: Data Store must be defined.");return c={name:b.name,version:b.version,storeName:b.storeName,description:b.description},Object.isDefined(b.driver)&&(c.driver=b.driver),Object.isNumeric(b.size)&&(c.size=b.size),d=b.dataStore.createInstance(c),localforageFind(d),d},h=function(a){return Math.floor(Math.random()*a+1)},i=function(b){var c;return Object.isDefined(b)&&(a.implementsInterface(b,"getNoSqlId")?c=b.getNoSqlId():Object.isDefined(b.getId())?c=b.getId():(c=(new Date).getTime()+h(9999999),b.getMethod("setId")(c))),c},j=function(b){var c,d;if(a.implementsInterface(b,"getNoSqlId"))c=b.getNoSqlId();else{if(!Object.isDefined(b.getId()))throw d="Could not get NoSQLId because targetEntity does not implement getNoSqlId() method and getId() method returns null or undefined",new a.dao.DaoException(d);c=b.getId()}return c},k=function(a){return"string"==typeof a||a instanceof String||"number"==typeof a||a instanceof Number?a.toString():JSON.stringify(a.toJSON())};a=a||{},a.dao=a.dao||a.namespace("software.bytepushers.data.dao"),a.dao.LocalForageDao=function(b){a.dao.LocalForageDao.prototype.superclass.apply(this,[b]),c=g(b)},a.dao.LocalForageDao.prototype=a.inherit(a.dao.GenericDAO.prototype),a.dao.LocalForageDao.prototype.constructor=a.dao.LocalForageDao,a.dao.LocalForageDao.prototype.superclass=a.dao.GenericDAO,a.dao.LocalForageDao.prototype.setDataStore=function(a){c=g(a)},a.dao.LocalForageDao.prototype.create=function(d){var g=this,h=new b(function(b,h){var l;try{if(!a.dao.LocalForageDao.prototype.isPrototypeOf(g))throw new a.dao.DaoException("Can not call object unless in LocalForageDao Object's hierarchy prototype chain.");f({description:"Entity",value:d},a.dao.DaoException,e)}catch(m){h(m)}l=(new a.util.Reflection).getInstance(d.constructor,d.toJSON()),i(l),c.setItem(k(j(l)),new d.constructor(l.toJSON()).toJSON()).then(function(a){return a}).then(function(a){var c=g.createEntity(a);b(c)})["catch"](function(b){h(new a.dao.DaoException(b))})});return h},a.dao.LocalForageDao.prototype.read=function(g){var h,i=this,j=new b(function(b,j){try{if(!a.dao.LocalForageDao.prototype.isPrototypeOf(i))throw new a.dao.DaoException("Can not call object unless in LocalForageDao Object's hierarchy prototype chain.");f({description:"Entity ID",value:g},a.dao.DaoException,e),f({description:"Entity ID",value:g},a.dao.DaoException,d)}catch(l){j(l)}c.getItem(k(g)).then(function(a){a&&(h=i.createEntity(a)),b(h)})["catch"](function(b){j(new a.dao.DaoException(b))})});return j},a.dao.LocalForageDao.prototype.getItems=function(d){var e=this,f=[],g=new b(function(b,g){d=Object.isArray(d)?d:[],d.length>0?c.getItems(d).then(function(a){Object.isArray(a)&&a.forEach(function(a){f.push(e.createEntity(a))}),b(f)})["catch"](function(b){g(new a.dao.DaoException(b))}):b(f)});return g},a.dao.LocalForageDao.prototype.setItems=function(d){var e=this,f=[],g=new b(function(b,g){d=Object.isArray(d)?d:[],d.length>0?(d.forEach(function(a){a.key=k(a.key),a.value=a.value.toJSON()}),c.setItems(d).then(function(a){Object.isArray(a)&&a.forEach(function(a){f.push(e.createEntity(a))}),b(f)})["catch"](function(b){g(new a.dao.DaoException(b))})):b(f)});return g},a.dao.LocalForageDao.prototype.findById=function(c){var d=new b(function(b,d){a.dao.LocalForageDao.read(c).then(function(a){b(a)})["catch"](function(a){b(null)})});return d},a.dao.LocalForageDao.prototype.find=function(a,d){var e=this,f=[],g=new b(function(b,g){c.find(a,d).then(function(a){a.forEach(function(a){f.push(e.createEntity(a))}),b(f)})["catch"](function(a){b(f)})});return g},a.dao.LocalForageDao.prototype.update=function(g){var h,l=this,m=new b(function(b,m){try{if(!a.dao.LocalForageDao.prototype.isPrototypeOf(l))throw new a.dao.DaoException("Can not call object unless in LocalForageDao Object's hierarchy prototype chain.");f({description:"Entity",value:g},a.dao.DaoException,e),f({description:"Entity ID",value:g.getId()},a.dao.DaoException,d)}catch(n){m(n)}h=(new a.util.Reflection).getInstance(g.constructor,g.toJSON()),i(h),c.setItem(k(j(h)),h.toJSON()).then(function(a){b(l.createEntity(a))})["catch"](function(b){m(new a.dao.DaoException(b))})});return m},a.dao.LocalForageDao.prototype["delete"]=function(g){var h=this,i=new b(function(b,i){try{if(!a.dao.LocalForageDao.prototype.isPrototypeOf(h))throw new a.dao.DaoException("Can not call object unless in LocalForageDao Object's hierarchy prototype chain.");f({description:"Entity ID",value:g},a.dao.DaoException,e),f({description:"Entity ID",value:g},a.dao.DaoException,d)}catch(j){i(j)}c.removeItem(k(g)).then(function(){b(!0)})["catch"](function(b){i(new a.dao.DaoException(b))})});return i}}(BytePushers,Promise),function(a,b){"use strict";void 0!==a.BytePushers&&null!==a.BytePushers?b=a.BytePushers:(a.BytePushers={},b=a.BytePushers),b.data=b.data||b.namespace("software.bytepushers.data.data"),b.data.DataException=function(a){b.data.DataException.prototype.superclass.apply(this,[a]),this.name="BytePushers.data.DataException",this.message=a},b.data.DataException.prototype=b.inherit(Error.prototype),b.data.DataException.prototype.constructor=b.data.DataException,b.data.DataException.prototype.superclass=Error,b.data.DataException.prototype.toString=function(){return this.name+"("+this.message+")"}}(window,BytePushers),function(a){"use strict";a=a||{},a.model=a.model||a.namespace("software.bytepushers.data.model"),a.model.NoSqlId=function(b){var c=Object.isDefined(b)&&Object.isNumeric(b.id)?b.id:null,d=Object.isDefined(b)&&Object.isString(b.demoMode)?b.demoMode:null,e=Object.isDefined(b)&&Object.isString(b.entityType)?b.entityType:null,f=Object.isDefined(b)&&Object.isString(b.dataId)?b.dataId:null,g=Object.isDefined(b)&&Object.isNumeric(b.dataShopId)?b.dataShopId:null,h=Object.isDefined(b)&&Object.isNumeric(b.dataLastModifiedTime)?b.dataLastModifiedTime:null;this.getId=function(){return c},this.getDemoMode=function(){return d},this.getEntityType=function(){return e},this.getDataId=function(){return f},this.getShopId=function(){return g},this.getDataLastModifiedTime=function(){return h},a.model.NoSqlId.prototype.toJSON=function(a){a=Boolean(a);var b=Object.isNumeric(this.getId())?this.getId():null,c=Object.isString(this.getDemoMode())?'"'+this.getDemoMode()+'"':null,d=Object.isString(this.getEntityType())?'"'+this.getEntityType()+'"':null,e=Object.isString(this.getDataId())?'"'+this.getDataId()+'"':null,f=Object.isNumeric(this.getShopId())?this.getShopId():null,g=Object.isNumeric(this.getDataLastModifiedTime())?this.getDataLastModifiedTime():null,h='{"id": '+b+',"demoMode": '+c+',"entityType": '+d+',"dataId": '+e+',"dataShopId": '+f+',"dataLastModifiedTime": '+g+"}";return a?h:JSON.parse(h)},a.model.NoSqlId.prototype.toString=function(){return"NoSqlId {id="+this.getId()+",demoMode="+this.getDemoMode()+",entityType="+this.getEntityType()+",dataId="+this.getDataId()+",dataShopId="+this.getShopId()+",dataLastModifiedTime="+this.getDataLastModifiedTime().toString()+"}"}}}(BytePushers),function(a){"use strict";a=a||{},a.strategy=a.strategy||a.namespace("software.bytepushers.data.strategy"),a.strategy.DataSyncConflictResolutionStrategy=function(){this.synchronizeData=function(b,c,d,e,f){var g;if(d=Boolean(d),!a.strategy.DataSyncConflictResolutionStrategy.prototype.isPrototypeOf(this))throw new a.data.DataException("Can not call object unless in Object's hierarchy prototype chain.");return g=d?this.synchronizeOnlineData(b,c,e,f):this.synchronizeOfflineData(b,c,e)},a.strategy.DataSyncConflictResolutionStrategy.prototype.synchronizeOnlineData=function(){if(!a.strategy.DataSyncConflictResolutionStrategy.prototype.isPrototypeOf(this))throw new a.data.DataException("Can not call object unless in Object's hierarchy prototype chain.");throw new a.data.DataException("abstract method")},a.strategy.DataSyncConflictResolutionStrategy.prototype.synchronizeOfflineData=function(){if(!a.strategy.DataSyncConflictResolutionStrategy.prototype.isPrototypeOf(this))throw new a.data.DataException("Can not call object unless in Object's hierarchy prototype chain.");throw new a.data.DataException("abstract method")},a.strategy.DataSyncConflictResolutionStrategy.prototype.convertResultsToMap=function(b){var c=new Map;return Object.isArray(b)&&b.forEach(function(b){a.implementsInterface(b,"getNoSqlId")?Object.isDefined(b)&&c.set(b.getNoSqlId(),b):console.log("Warning: "+b+" does not implement getNoSqlId() method.")}),c}}}(BytePushers),function(a){"use strict";a=a||{},a.strategy=a.strategy||a.namespace("software.bytepushers.data.strategy"),a.strategy.DataSyncConflictResolutionClientWinsStrategy=function(){a.strategy.DataSyncConflictResolutionClientWinsStrategy.prototype.superclass.apply(this,[]),a.strategy.DataSyncConflictResolutionClientWinsStrategy.prototype.synchronizeOnlineData=function(b,c,d,e){var f=new Promise(function(f,g){if(!Object.isDefined(b))throw new a.exceptions.NullPointerException("dirtyOfflineDataSearchCriteria parameter must be defined.");if(!Object.isDate(c))throw new a.exceptions.NullPointerException("lastSynchronizedTime parameter must be defined as a Date.");if(!Object.isDefined(d))throw new a.exceptions.NullPointerException("someDao parameter must be defined.");if(!Object.isDefined(e))throw new a.exceptions.NullPointerException("dataSynchronizationService parameter must be defined.");e.getChanges(c).then(function(a){return this.convertResultsToMap(a)}).then(function(c){return d.find(b).then(function(b){var d;b.forEach(function(b){a.implementsInterface(b,"getNoSqlId")?(d=c.get(b.getNoSqlId()),Object.isDefined(d)&&c.remove(d.getNoSqlId())):console.log("Warning: "+b+" does not implement getNoSqlId() method."),e.save(b)})}),c}).then(function(a){Object.isDefined(a)&&a.toArray().forEach(function(b){d.create(b),a.remove(b.getNoSqlId())}),f(!0)})["catch"](function(b){g(new a.dao.DataException(b))})});return f},a.strategy.DataSyncConflictResolutionClientWinsStrategy.prototype.synchronizeOfflineData=function(){var a=new Promise(function(a){a(!0)});return a}},a.strategy.DataSyncConflictResolutionClientWinsStrategy.prototype=a.inherit(a.strategy.DataSyncConflictResolutionStrategy.prototype),a.strategy.DataSyncConflictResolutionClientWinsStrategy.prototype.constructor=a.strategy.DataSyncConflictResolutionClientWinsStrategy,a.strategy.DataSyncConflictResolutionClientWinsStrategy.prototype.superclass=a.strategy.DataSyncConflictResolutionStrategy}(BytePushers),function(a){"use strict";a=a||{},a.strategy=a.strategy||a.namespace("software.bytepushers.data.strategy"),a.strategy.DataSyncConflictResolutionServerWinsStrategy=function(){a.strategy.DataSyncConflictResolutionServerWinsStrategy.prototype.superclass.apply(this,[]),a.strategy.DataSyncConflictResolutionServerWinsStrategy.prototype.synchronizeOnlineData=function(b,c,d,e){var f=new Map,g=new Promise(function(g,h){if(!Object.isDefined(b))throw new a.exceptions.NullPointerException("searchCriteria parameter must be defined.");if(!Object.isDate(c))throw new a.exceptions.NullPointerException("lastSynchronizedTime parameter must be defined as a Date.");if(!Object.isDefined(d))throw new a.exceptions.NullPointerException("daoManager parameter must be defined.");if(!Object.isDefined(e))throw new a.exceptions.NullPointerException("dataSynchronizationService parameter must be defined.");d.find(b).then(function(b){var c=!1;return b.forEach(function(b){a.implementsInterface(b,"getNoSqlId")?(f.set(b.getNoSqlId(),b),c=!0):console.log("Warning: "+b+" does not implement getNoSqlId() method.")}),c}).then(function(){return e.getChanges(c)}).then(function(a){var b;a.forEach(function(c,e){Object.isDefined(c)&&(b=f.get(c.getNoSqlId()),Object.isDefined(b)?(a.splice(e,1),d.update(c)):d.create(c))}),g(!0)})["catch"](function(b){h(new a.dao.DataException(b))})});return g},a.strategy.DataSyncConflictResolutionServerWinsStrategy.prototype.synchronizeOfflineData=function(){var a=new Promise(function(a){a(!0)});return a}},a.strategy.DataSyncConflictResolutionServerWinsStrategy.prototype=a.inherit(a.strategy.DataSyncConflictResolutionStrategy.prototype),a.strategy.DataSyncConflictResolutionServerWinsStrategy.prototype.constructor=a.strategy.DataSyncConflictResolutionServerWinsStrategy,a.strategy.DataSyncConflictResolutionServerWinsStrategy.prototype.superclass=a.strategy.DataSyncConflictResolutionStrategy}(BytePushers);